---
title: 'RSA算法原理及CTF解题'
description: '一篇质量极高的RSA原理解释和CTF Crypto的解题思路'
date: '2023-05-23'
categories: 'CTF'
---

The RSA encryption algorithm is an asymmetric encryption algorithm. RSA is widely used in public key cryptography and electronic commerce. RSA was proposed in 1977 by Ron Rivest, Adi Shamir, and Leonard Adleman. All three of them were working at the Massachusetts Institute of Technology. RSA is composed of the first three letters of their last names.

## RSA算法原理

### 什么是RSA

RSA算法是现今使用最广泛的公钥密码算法，也是号称地球上最安全的加密算法。在了解RSA算法之前，先熟悉下几个术语。

根据密钥的使用方法，可以将密码分为对称加密和公钥加密：

+   对称密码：加密和解密使用同一种密钥的方式
+   公钥密码：加密和解密使用不同密码的方式，因此公钥密码通常也称为非对称密码。

### RSA加密

RSA的加密过程可以使用一个通式来表达

![image-20201031173019174](/public/images/blog/rsa/20201031173019174.png)

**也就是说RSA加密是对明文的E次方后除以N后求余数的过程。**

从通式可知，**只要知道E和N任何人都可以进行RSA加密了**，所以说E、N是RSA加密的密钥，也就是说**E和N的组合就是公钥，我们用(E,N)来表示公钥。**

![image-20201031173255185](https://i-blog.csdnimg.cn/blog_migrate/da28097194304ce5221605611d500f23.png)

不过E和N不并不是随便什么数都可以的，它们都是经过严格的数学计算得出的，关于E和N拥有什么样的要求及其特性后面会讲到。顺便啰嗦一句E是加密（Encryption）的首字母，N是数字（Number）的首字母

### RSA解密

RSA的解密同样可以使用一个通式来表达

![image-20201031173330422](https://i-blog.csdnimg.cn/blog_migrate/f0e540ab5c3770e867a8ea2a03612b3a.png)

也就是说对密文进行D次方后除以N的余数就是明文，这就是RSA解密过程。知道D和N就能进行解密密文了，所以D和N的组合就是私钥

![image-20201031173416580](https://i-blog.csdnimg.cn/blog_migrate/38d565608384a53bcd3b1fb2977a5828.png)

从上述可以看出RSA的加密方式和解密方式是相同的，加密是求“E次方的mod N”，解密是求“D次方的mod N”  
此处D是解密（Decryption）的首字母；N是数字（Number）的首字母。

**总结一下**

|  |  |
| --- | --- |
| **公钥** | **（E，N）** |
| **私钥** | **（D，N）** |
| **密钥对** | **（E，D，N）** |
| 加密 | 密文＝明文^E mod N |
| 解密 | 明文＝密文^D mod N |

### 生成密钥对

既然公钥是（E，N），私钥是（D，N）所以密钥对即为（E，D，N）但密钥对是怎样生成的？步骤如下：

1.  求N
2.  求L（L为计算过程的中间数）
3.  求E
4.  求D

#### 1\. 求N

准备两个质数p，q。这两个数不能太小，太小则会容易破解，将p乘以q就是N

+   **N = p\*q**

#### 2\. 求欧拉函数φ(N)

然后计算欧拉函数φ(N)或L：

+   **φ(N) = (p-1) \* (q-1)**

#### 3\. 求E

E 必须满足两个条件：E 是一个比1大比φ(N)小的数，E 和 φ(N) 的最大公约数为1，即 E 和 φ(N) 互质

用gcd(X,Y)来表示X，Y的最大公约数则E条件如下：

+   **1 < E < φ(N)**
+   **gcd(E,φ(N)) = 1**

之所以需要E和φ(N)的最大公约数为1是为了保证一定存在解密时需要使用的数D。现在我们已经求出了E和N也就是说我们已经生成了密钥对中的公钥了。

#### 4\. 求D

数D是由数E计算出来的。D、E和φ(N)之间必须满足以下关系：

+   **1 < D < φ(N)**
+   **(E \* D) mod φ(N) = 1**

只要D满足上述2个条件，则通过E和N进行加密的密文就可以用D和N进行解密。  
简单地说条件2是为了保证密文解密后的数据就是明文。  
现在私钥自然也已经生成了，密钥对也就自然生成了。

